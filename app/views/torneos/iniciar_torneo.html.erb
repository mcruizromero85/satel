          <script type="text/javascript">

            var minimalData = {
              <%   cantidad_inscripciones=@torneo.vacantes %>
              teams : <%=raw TorneosHelper.array_para_llaves(@torneo)%>,
              results: <%=raw TorneosHelper.obtener_array_para_resultado_llaves(@torneo)%>
            }
          $(function() {
            $('#llaves').bracket({
            init: minimalData,
            skipConsolationRound: true
            <% if @torneo.estado == "Iniciado" && @current_gamer==@torneo.gamer %>
            ,onMatchClick: registrarGanador,
            decorator: {edit: edit_fn,render: render_fn}})
            <% end %>
          })
          <% if @torneo.estado == "Iniciado" && @current_gamer==@torneo.gamer %>
            function registrarGanador(data) {
              if (data == "0"){
                alert("No existe ambos contrincantes");                
              }else{
                location.href="/encuentros/"+data+"/edit";  
              }
            }

            function edit_fn(container, data, doneCb) {
              var input = $('<input type="text">')
              input.val(data.name)
              container.html(input)
              input.focus()
              input.blur(function() { doneCb({name: input.val()}) })
            }

            function render_fn(container, data, score) {
              $('#llaves div .tools').addClass('ocultar_contenido');
              container.append(data);
            }
          <% else %>
          })
          <% end %>

          </script> 
          <section class="FrmRegistrarTorneo">
            <% if @torneo.estado == "Iniciado"  %>  
              <h1 class="text-center"><u>Torneo en Curso</u></h1>
            <% else%>
              <h1 class="text-center"><u>Prepara tu torneo antes de iniciar</u></h1>
            <% end %>  
            <h3 class="text-center"><%= @torneo.titulo %></h3>
            <h4 class="text-center"><%= @torneo.paginaweb %></h4>
            <center>
              <a class = "Lkn_DetalleTorneo" href="/torneos/<%=@torneo.id%>">Ver detalle del detalle del torneo</a>
            </center>
            <br/>
            <% if @torneo.errors.any? %>
              <div id="error_explanation">
                <h2><%= pluralize(@torneo.errors.count, "error") %> No permiten registrar el torneo:</h2>
                <ul>
                <% @torneo.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
                <% end %>
                </ul>
              </div>
            <% end %>
            <%= form_tag({controller: "torneos", action: "comenzar"}, method: "post") %>
             <% if @torneo.estado != "Iniciado" and @torneo.gamer == current_gamer %>
             <input id="estado" type="hidden" name="estado" value="Iniciado" />
                <center>
                  <a class = "Lkn_DetalleTorneo" href="/torneos/iniciar/<%=@torneo.id%>">Volver a generar</a>       
                    <br>
                       <br>
                        <center><input name="commit" type="submit" value="Iniciar Torneo!!!" /></center>
                        <input name="id_torneo" type="hidden" value="<%=@torneo.id%>" />
                </center>
            <% end %>
          <div id="llaves" class="table-responsive" ></div> 
</section>